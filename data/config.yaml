inputs:
  - cal_items:
      - filepath: /Users/mmccrackan/toltec/simu_stuff/pointSource_simu/Pointing_1.0/apt_000001_000_0000_2021_09_04_16_26_41_trimmed.ecsv
        meta:
          interface: apt
        type: array_prop_table
      - type: photometry
        beammap_source:
          name: S1
          ra_deg: 180.
          dec_deg: 0.
          fluxes:
          - array_name: a1100
            value_mJy: 1.
            uncertainty_mJy: 0.05
          - array_name: a1400
            value_mJy: 2.
            uncertainty_mJy: 0.05
          - array_name: a2000
            value_mJy: 3.
            uncertainty_mJy: 0.05
        extinction:
          model_name: "some_model"
          tau_220: 0.3
      - type: astrometry
        pointing_offsets:
        - axes_name: az
          value_arcsec: 1
        - axes_name: alt
          value_arcsec: 1.2
    data_items:
      - filepath: /Users/mmccrackan/toltec/simu_stuff/pointSource_simu/Pointing_1.0/tel_000001_000_0000_2021_09_04_16_26_41.nc
        meta:
          interface: lmt
      - filepath: /Users/mmccrackan/toltec/simu_stuff/pointSource_simu/Pointing_1.0/hwp_000001_000_0000_2021_09_04_16_26_41.nc
        meta:
          interface: hwp
      - filepath: /Users/mmccrackan/toltec/simu_stuff/pointSource_simu/Pointing_1.0/toltec0_000001_000_0000_2021_09_04_16_26_41_timestream.nc
        meta:
          interface: toltec0
      - filepath: /Users/mmccrackan/toltec/simu_stuff/pointSource_simu/Pointing_1.0/toltec1_000001_000_0000_2021_09_04_16_26_41_timestream.nc
        meta:
          interface: toltec1
      - filepath: /Users/mmccrackan/toltec/simu_stuff/pointSource_simu/Pointing_1.0/toltec2_000001_000_0000_2021_09_04_16_26_41_timestream.nc
        meta:
          interface: toltec2
      - filepath: /Users/mmccrackan/toltec/simu_stuff/pointSource_simu/Pointing_1.0/toltec3_000001_000_0000_2021_09_04_16_26_41_timestream.nc
        meta:
          interface: toltec3
      - filepath: /Users/mmccrackan/toltec/simu_stuff/pointSource_simu/Pointing_1.0/toltec4_000001_000_0000_2021_09_04_16_26_41_timestream.nc
        meta:
          interface: toltec4
      - filepath: /Users/mmccrackan/toltec/simu_stuff/pointSource_simu/Pointing_1.0/toltec5_000001_000_0000_2021_09_04_16_26_41_timestream.nc
        meta:
          interface: toltec5
      - filepath: /Users/mmccrackan/toltec/simu_stuff/pointSource_simu/Pointing_1.0/toltec6_000001_000_0000_2021_09_04_16_26_41_timestream.nc
        meta:
          interface: toltec6
      - filepath: /Users/mmccrackan/toltec/simu_stuff/pointSource_simu/Pointing_1.0/toltec7_000001_000_0000_2021_09_04_16_26_41_timestream.nc
        meta:
          interface: toltec7
      - filepath: /Users/mmccrackan/toltec/simu_stuff/pointSource_simu/Pointing_1.0/toltec8_000001_000_0000_2021_09_04_16_26_41_timestream.nc
        meta:
          interface: toltec8
      - filepath: /Users/mmccrackan/toltec/simu_stuff/pointSource_simu/Pointing_1.0/toltec9_000001_000_0000_2021_09_04_16_26_41_timestream.nc
        meta:
          interface: toltec9
      - filepath: /Users/mmccrackan/toltec/simu_stuff/pointSource_simu/Pointing_1.0/toltec10_000001_000_0000_2021_09_04_16_26_41_timestream.nc
        meta:
          interface: toltec10
      - filepath: /Users/mmccrackan/toltec/simu_stuff/pointSource_simu/Pointing_1.0/toltec11_000001_000_0000_2021_09_04_16_26_41_timestream.nc
        meta:
          interface: toltec11
      - filepath: /Users/mmccrackan/toltec/simu_stuff/pointSource_simu/Pointing_1.0/toltec12_000001_000_0000_2021_09_04_16_26_41_timestream.nc
        meta:
          interface: toltec12
    meta:
      name: 1_0_0
kids:
  fitter:
    modelspec: gainlintrend
    weight_window:
      fwhm_Hz: 1.5e4
      type: lorentz
  solver:
runtime:
  parallel_policy: seq # seq, omp, tbb
  n_threads: 1 # number of threads to parallelize over
  output_dir: /Users/mmccrackan/toltec/simu_stuff/pointSource_simu/Pointing_1.0_reduce/ #root path
  reduction_type: pointing #beammap, pointing, etc
  meta:
    version: tolteca...
    #high level config settings
interface_sync_offset: #dict for each toltec[0..12]+hwp+lmt/  #match keys with file interface key
  - toltec0: 0
  - toltec1: 0
  - toltec2: 0
  - toltec3: 0
  - toltec4: 0
  - toltec5: 0
  - toltec6: 0
  - toltec7: 0
  - toltec8: 0
  - toltec9: 0
  - toltec10: 0
  - toltec11: 0
  - toltec12: 0
  - hwp: 0
timestream:
  chunking:
    length_sec: 10.0
  weighting:
    type: full #approximate
  despike:
    enabled: true
    min_spike_sigma: 8.0
    time_constant_sec: 0.015
    window_size: 32
  filter:
    enabled: true
    a_gibbs: 50.0
    freq_high_Hz: 16.0
    freq_low_Hz: 0.0
    n_terms: 32
  downsample:
    enabled: true
    factor: 1
  kernel:
    enabled: true
    filepath: null
    type: internal_gaussian #image, internal_airy
  clean:
    enabled: true
    cut_std: 0.0
    grouping: array_name
    n_eig_to_cut: 3
mapmaking:
  grouping: array_name #array, detector, polarization, nw
  method: naive #jinc, maximum_likelihood (toast)?
  pixel_axes: altaz #icrs, lb
  pixel_size_arcsec: 0.75
  crval1_J2000: null #absolute pointing_x
  crval2_J2000: null #absolute pointing_y
  crpix1: null
  crpix2: null
  x_size_pix: null #null or value
  y_size_pix: null #null or value
beammap:
  iter_tolerance: 0.2
  iter_max: 1
source_fitting:
  enabled: true
  model: gaussian
  bounding_box_arcsec: 10
  initial_guess: brightest_pixel #table
coadd:
  enabled: true
  noise_maps:
    enabled: true
    n_noise_maps: 100
  filtering:
    enabled: true
    type: wiener_filter
wiener_filter:
  gaussian_template: true
  gaussian_template_fwhm_arcsec:
    a1100: 5
    a1400: 6.3
    a2000: 9.5
  lowpass_only: false
  highpass_only: false
  normalize_error: false
