inputs:
  - cal_items:
      - filepath: /path/to/raw/data/directory/apt_000001_000_0000_2021_09_04_16_26_41_trimmed.ecsv
        meta:
          interface: apt
        type: array_prop_table
      - type: photometry
        beammap_source:
          name: S1
          ra_deg: 180.
          dec_deg: 0.
          fluxes:
          - array_name: a1100
            value_mJy: 1.
            uncertainty_mJy: 0.05
          - array_name: a1400
            value_mJy: 2.
            uncertainty_mJy: 0.05
          - array_name: a2000
            value_mJy: 3.
            uncertainty_mJy: 0.05
        extinction:
          model_name: "some_model"
          tau_220: 0.3
      - type: astrometry
        pointing_offsets:
        - axes_name: az
          value_arcsec: 1
        - axes_name: alt
          value_arcsec: 1.2
    data_items:
      - filepath: /path/to/raw/data/directory/tel_000001_000_0000_2021_09_04_16_26_41.nc
        meta:
          interface: lmt
      - filepath: /path/to/raw/data/directory/hwp_000001_000_0000_2021_09_04_16_26_41.nc
        meta:
          interface: hwp
      - filepath: /path/to/raw/data/directory/toltec0_000001_000_0000_2021_09_04_16_26_41_timestream.nc
        meta:
          interface: toltec0
      - filepath: /path/to/raw/data/directory/toltec1_000001_000_0000_2021_09_04_16_26_41_timestream.nc
        meta:
          interface: toltec1
      - filepath: /path/to/raw/data/directory/toltec2_000001_000_0000_2021_09_04_16_26_41_timestream.nc
        meta:
          interface: toltec2
      - filepath: /path/to/raw/data/directory/toltec3_000001_000_0000_2021_09_04_16_26_41_timestream.nc
        meta:
          interface: toltec3
      - filepath: /path/to/raw/data/directory/toltec4_000001_000_0000_2021_09_04_16_26_41_timestream.nc
        meta:
          interface: toltec4
      - filepath: /path/to/raw/data/directory/toltec5_000001_000_0000_2021_09_04_16_26_41_timestream.nc
        meta:
          interface: toltec5
      - filepath: /path/to/raw/data/directory/toltec6_000001_000_0000_2021_09_04_16_26_41_timestream.nc
        meta:
          interface: toltec6
      - filepath: /path/to/raw/data/directory/toltec7_000001_000_0000_2021_09_04_16_26_41_timestream.nc
        meta:
          interface: toltec7
      - filepath: /path/to/raw/data/directory/toltec8_000001_000_0000_2021_09_04_16_26_41_timestream.nc
        meta:
          interface: toltec8
      - filepath: /path/to/raw/data/directory/toltec9_000001_000_0000_2021_09_04_16_26_41_timestream.nc
        meta:
          interface: toltec9
      - filepath: /path/to/raw/data/directory/toltec10_000001_000_0000_2021_09_04_16_26_41_timestream.nc
        meta:
          interface: toltec10
      - filepath: /path/to/raw/data/directory/toltec11_000001_000_0000_2021_09_04_16_26_41_timestream.nc
        meta:
          interface: toltec11
      - filepath: /path/to/raw/data/directory/toltec12_000001_000_0000_2021_09_04_16_26_41_timestream.nc
        meta:
          interface: toltec12
    meta:
      name: 1_0_0
kids:
  fitter:
    modelspec: gainlintrend
    weight_window:
      fwhm_Hz: 1.5e4
      type: lorentz
  solver:
runtime:
  parallel_policy: seq # seq, omp, tbb
  n_threads: 1 # number of threads to parallelize over
  output_dir: /path/to/reduction/directory/ #root path
  reduction_type: science #beammap, pointing, etc
  meta:
    version: tolteca...
    #high level config settings
interface_sync_offset: #dict for each toltec[0..12]+hwp+lmt/  #match keys with file interface key
  - toltec0: 0
  - toltec1: 0
  - toltec2: 0
  - toltec3: 0
  - toltec4: 0
  - toltec5: 0
  - toltec6: 0
  - toltec7: 0
  - toltec8: 0
  - toltec9: 0
  - toltec10: 0
  - toltec11: 0
  - toltec12: 0
  - hwp: 0
timestream:
  polariametry:
    enabled: false
  output:
    enabled: false
    format: netcdf
    chunk_type: rtc #ptc, both
  chunking:
    length_sec: 10.0
  weighting:
    type: full #approximate
  despike:
    enabled: false
    min_spike_sigma: 8.0
    time_constant_sec: 0.015
    window_size: 32
  filter:
    enabled: false
    a_gibbs: 50.0
    freq_high_Hz: 16.0
    freq_low_Hz: 0.0
    n_terms: 32
  downsample:
    enabled: true
    factor: 1
  kernel:
    enabled: false
    filepath: null
    image_ext_name: signal
    type: internal_gaussian #image, internal_airy
  clean:
    enabled: false
    cut_std: 0.0
    grouping: array_name
    n_eig_to_cut: 3
mapmaking:
  cunit: "MJy/Sr" # mJy/beam
  crpix1: 0
  crpix2: 0
  crval1_J2000: 0
  crval2_J2000: 0
  grouping: array_name
  method: naive
  pixel_axes: icrs
  pixel_size_arcsec: 1.0
  x_size_pix: 0
  y_size_pix: 0
beammap:
  iter_tolerance: 0.2
  iter_max: 1
source_fitting:
  enabled: false
  model: gaussian
  bounding_box_arcsec: 10
  initial_guess: brightest_pixel #table
coadd:
  enabled: false
  cov_cut: 0.75
  noise_maps:
    enabled: false
    n_noise_maps: 30
  filtering:
    enabled: true
    type: wiener_filter
wiener_filter:
  gaussian_template: true
  gaussian_template_fwhm_arcsec:
    a1100: 5
    a1400: 6.3
    a2000: 9.5
  lowpass_only: false
  highpass_only: false
  normalize_error: false
